# DrawManager.test.js before optimization

Optimization was using the totals present in the SortitionSumTree data structure.

·-------------------------------------------------------------------------|----------------------------·
|                                   Gas                                   ·  Block limit: 6721975 gas  │
··········································································|·····························
|  Methods                                                                                             │
·······················|················|··········|··········|···········|··············|··············
|  Contract            ·  Method        ·  Min     ·  Max     ·  Avg      ·  # calls     ·  usd (avg)  │
·······················|················|··········|··········|···········|··············|··············
|  ExposedDrawManager  ·  deposit       ·   53419  ·  245885  ·   116060  ·          16  ·          -  │
·······················|················|··········|··········|···········|··············|··············
|  ExposedDrawManager  ·  openNextDraw  ·  143207  ·  197060  ·   169190  ·           3  ·          -  │
·······················|················|··········|··········|···········|··············|··············
|  Deployments                          ·                                 ·  % of limit  ·             │
········································|··········|··········|···········|··············|··············
|  DrawManager                          ·       -  ·       -  ·  1190723  ·      17.7 %  ·          -  │
········································|··········|··········|···········|··············|··············
|  ExposedDrawManager                   ·       -  ·       -  ·   524185  ·       7.8 %  ·          -  │
········································|··········|··········|···········|··············|··············
|  SortitionSumTreeFactory              ·       -  ·       -  ·   679690  ·      10.1 %  ·          -  │
·---------------------------------------|----------|----------|-----------|--------------|-------------·

# DrawManager.test.js After optimization

·-------------------------------------------------------------------------|----------------------------·
|                                   Gas                                   ·  Block limit: 6721975 gas  │
········································|·································|·····························
|  Methods                              ·           10 gwei/gas           ·       172.68 usd/eth       │
·······················|················|··········|··········|···········|··············|··············
|  Contract            ·  Method        ·  Min     ·  Max     ·  Avg      ·  # calls     ·  usd (avg)  │
·······················|················|··········|··········|···········|··············|··············
|  ExposedDrawManager  ·  deposit       ·   50623  ·  211899  ·   107341  ·          16  ·       0.19  │
·······················|················|··········|··········|···········|··············|··············
|  ExposedDrawManager  ·  openNextDraw  ·  140636  ·  179489  ·   161619  ·           3  ·       0.28  │
·······················|················|··········|··········|···········|··············|··············
|  Deployments                          ·                                 ·  % of limit  ·             │
········································|··········|··········|···········|··············|··············
|  DrawManager                          ·       -  ·       -  ·  1232639  ·      18.3 %  ·       2.13  │
········································|··········|··········|···········|··············|··············
|  ExposedDrawManager                   ·       -  ·       -  ·   544705  ·       8.1 %  ·       0.94  │
········································|··········|··········|···········|··············|··············
|  SortitionSumTreeFactory              ·       -  ·       -  ·   679690  ·      10.1 %  ·       1.17  │
·---------------------------------------|----------|----------|-----------|--------------|-------------·

# Pool.test.js Before optimization

·----------------------------------------------------------------------------|----------------------------·
|                                    Gas                                     ·  Block limit: 6721975 gas  │
·············································································|·····························
|  Methods                                                                                                │
···············|·························|···········|···········|···········|··············|··············
|  Contract    ·  Method                 ·  Min      ·  Max      ·  Avg      ·  # calls     ·  usd (avg)  │
···············|·························|···········|···········|···········|··············|··············
|  CErc20Mock  ·  reward                 ·        -  ·        -  ·    28243  ·           7  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  addAdmin               ·        -  ·        -  ·    45270  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  depositPool            ·   121670  ·   289796  ·   267075  ·          14  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  depositSponsorship     ·        -  ·        -  ·   106538  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  init                   ·   122835  ·   138219  ·   126681  ·           8  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  openNextDraw           ·   168834  ·   285812  ·   244284  ·          17  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  pause                  ·        -  ·        -  ·    43582  ·           2  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  removeAdmin            ·        -  ·        -  ·    15669  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  rewardAndOpenNextDraw  ·   279721  ·   420031  ·   388227  ·           7  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  setNextFeeBeneficiary  ·        -  ·        -  ·    29770  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  setNextFeeFraction     ·        -  ·        -  ·    43445  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  unpause                ·        -  ·        -  ·    14221  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  withdraw               ·    48460  ·   184455  ·   137719  ·           6  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Token       ·  approve                ·    45604  ·    45668  ·    45630  ·          17  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Deployments                           ·                                   ·  % of limit  ·             │
·········································|···········|···········|···········|··············|··············
|  CErc20Mock                            ·        -  ·        -  ·   474747  ·       7.1 %  ·          -  │
·········································|···········|···········|···········|··············|··············
|  DrawManager                           ·  1189763  ·  1190723  ·  1190620  ·      17.7 %  ·          -  │
·········································|···········|···········|···········|··············|··············
|  Pool                                  ·  2440112  ·  2440624  ·  2440567  ·      36.3 %  ·          -  │
·········································|···········|···········|···········|··············|··············
|  SortitionSumTreeFactory               ·        -  ·        -  ·   679690  ·      10.1 %  ·          -  │
·········································|···········|···········|···········|··············|··············
|  Token                                 ·        -  ·        -  ·   785913  ·      11.7 %  ·          -  │
·----------------------------------------|-----------|-----------|-----------|--------------|-------------·

# Pool.test.js after optimization

Optimization included: DrawManager totals DRY

·----------------------------------------------------------------------------|----------------------------·
|                                    Gas                                     ·  Block limit: 6721975 gas  │
·············································································|·····························
|  Methods                                                                                                │
···············|·························|···········|···········|···········|··············|··············
|  Contract    ·  Method                 ·  Min      ·  Max      ·  Avg      ·  # calls     ·  usd (avg)  │
···············|·························|···········|···········|···········|··············|··············
|  CErc20Mock  ·  reward                 ·        -  ·        -  ·    28243  ·           7  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  addAdmin               ·        -  ·        -  ·    45270  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  depositPool            ·   118874  ·   272000  ·   252494  ·          14  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  depositSponsorship     ·        -  ·        -  ·   106538  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  init                   ·   122835  ·   138219  ·   126681  ·           8  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  openNextDraw           ·   166263  ·   268241  ·   236746  ·          17  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  pause                  ·        -  ·        -  ·    43582  ·           2  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  removeAdmin            ·        -  ·        -  ·    15669  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  rewardAndOpenNextDraw  ·   267313  ·   409892  ·   377764  ·           7  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  setNextFeeBeneficiary  ·        -  ·        -  ·    29770  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  setNextFeeFraction     ·        -  ·        -  ·    43445  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  unpause                ·        -  ·        -  ·    14221  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  withdraw               ·    48460  ·   176369  ·   130981  ·           6  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Token       ·  approve                ·    45604  ·    45668  ·    45630  ·          17  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Deployments                           ·                                   ·  % of limit  ·             │
·········································|···········|···········|···········|··············|··············
|  CErc20Mock                            ·        -  ·        -  ·   474747  ·       7.1 %  ·          -  │
·········································|···········|···········|···········|··············|··············
|  DrawManager                           ·  1231487  ·  1232639  ·  1232516  ·      18.3 %  ·          -  │
·········································|···········|···········|···········|··············|··············
|  Pool                                  ·  2460774  ·  2461350  ·  2461288  ·      36.6 %  ·          -  │
·········································|···········|···········|···········|··············|··············
|  SortitionSumTreeFactory               ·        -  ·        -  ·   679690  ·      10.1 %  ·          -  │
·········································|···········|···········|···········|··············|··············
|  Token                                 ·        -  ·        -  ·   785913  ·      11.7 %  ·          -  │
·----------------------------------------|-----------|-----------|-----------|--------------|-------------·

# Pool.test.js results after further optimization

Removed reentrancy protection

·----------------------------------------------------------------------------|----------------------------·
|                                    Gas                                     ·  Block limit: 6721975 gas  │
·············································································|·····························
|  Methods                                                                                                │
···············|·························|···········|···········|···········|··············|··············
|  Contract    ·  Method                 ·  Min      ·  Max      ·  Avg      ·  # calls     ·  usd (avg)  │
···············|·························|···········|···········|···········|··············|··············
|  CErc20Mock  ·  reward                 ·        -  ·        -  ·    28243  ·           7  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  addAdmin               ·        -  ·        -  ·    45270  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  depositPool            ·   113428  ·   251554  ·   235262  ·          14  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  depositSponsorship     ·        -  ·        -  ·   101092  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  init                   ·   122835  ·   138219  ·   126681  ·           8  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  openNextDraw           ·   166263  ·   268241  ·   236746  ·          17  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  pause                  ·        -  ·        -  ·    43582  ·           2  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  removeAdmin            ·        -  ·        -  ·    15669  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  rewardAndOpenNextDraw  ·   267313  ·   409892  ·   377764  ·           7  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  setNextFeeBeneficiary  ·        -  ·        -  ·    29770  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  setNextFeeFraction     ·        -  ·        -  ·    43445  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  unpause                ·        -  ·        -  ·    14221  ·           1  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Pool        ·  withdraw               ·    45737  ·   173646  ·   127350  ·           6  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Token       ·  approve                ·    45604  ·    45668  ·    45630  ·          17  ·          -  │
···············|·························|···········|···········|···········|··············|··············
|  Deployments                           ·                                   ·  % of limit  ·             │
·········································|···········|···········|···········|··············|··············
|  CErc20Mock                            ·        -  ·        -  ·   474747  ·       7.1 %  ·          -  │
·········································|···········|···········|···········|··············|··············
|  DrawManager                           ·  1231487  ·  1232639  ·  1232516  ·      18.3 %  ·          -  │
·········································|···········|···········|···········|··············|··············
|  Pool                                  ·  2441312  ·  2441888  ·  2441826  ·      36.3 %  ·          -  │
·········································|···········|···········|···········|··············|··············
|  SortitionSumTreeFactory               ·        -  ·        -  ·   679690  ·      10.1 %  ·          -  │
·········································|···········|···········|···········|··············|··············
|  Token                                 ·        -  ·        -  ·   785913  ·      11.7 %  ·          -  │
·----------------------------------------|-----------|-----------|-----------|--------------|-------------·