# PoolTogether Contracts

[![CircleCI](https://circleci.com/gh/pooltogether/pooltogether-contracts/tree/v2.x.svg?style=svg)](https://circleci.com/gh/pooltogether/pooltogether-contracts/tree/v2.x)

[Code Coverage](https://v2.coverage.pooltogether.us/)

PoolTogether is a prize-linked savings account built on Ethereum. This project contains the Ethereum smart contracts that power the protocol. Users deposit into the pool and receive tickets in exchange.  The pooled deposits earn interest in [Compound](https://compound.finance), and periodically the total interest is awarded to a randomly selected ticket holder.  You can read more about the algorithm in the article [Inside PoolTogether v2.0](https://medium.com/pooltogether/inside-pooltogether-v2-0-e7d0e1b90a08).

**If you want to run PoolTogether locally in an isolated test environment check out the [PoolTogether Mock](https://github.com/pooltogether/pooltogether-contracts-mock) project**

# Ethereum Networks

| Network | Address |
| ------- | ------- |
| mainnet | [0xb7896fce748396EcFC240F5a0d3Cc92ca42D7d84](https://etherscan.io/address/0xb7896fce748396EcFC240F5a0d3Cc92ca42D7d84) |
| rinkeby | [0xf6535134C89D5e32ccE2C88E7847e207164E754F](https://rinkeby.etherscan.io/address/0xf6535134C89D5e32ccE2C88E7847e207164E754F) |

# Setup

Clone the repo and then install deps:

```
$ yarn
```

# Testing

To run the entire test suite and see the gas usage:

```
$ yarn test
```

Ignore the warnings.

# Coverage

To run the coverage checks:

```
$ yarn coverage
```

# Deploying to Rinkeby

Copy over .envrc and allow direnv:

```
$ cp .envrc.example .envrc
$ direnv allow
```

If you change `HDWALLET_MNEMONIC` then you'll need to update `ADMIN_ADDRESS` as well.  I like to use the second address generated by the `HDWALLET_MNEMONIC`.

To deploy the project to Rinkeby:

```
yarn session-rinkeby
yarn push
yarn migrate-rinkeby
```
